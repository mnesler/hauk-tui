#!/bin/bash
#
# Pre-commit hook for Hauk-TUI
# Runs build verification before allowing commits
#
# Installation:
#   cp scripts/pre-commit .git/hooks/pre-commit
#   chmod +x .git/hooks/pre-commit
#

echo "ğŸ”¨ Running pre-commit checks..."
echo ""

# Check if Go is installed
if ! command -v go &> /dev/null; then
    echo "âš ï¸  Warning: Go is not installed or not in PATH"
    echo "   Skipping build verification"
    echo ""
    exit 0
fi

# Run the build
echo "ğŸ“¦ Building application..."
if go build -o bin/hauk ./cmd/hauk/main.go; then
    echo "âœ… Build successful!"
    echo ""
    
    # Optionally run tests (uncomment to enable)
    # echo "ğŸ§ª Running tests..."
    # if go test ./...; then
    #     echo "âœ… Tests passed!"
    #     echo ""
    # else
    #     echo "âŒ Tests failed!"
    #     echo ""
    #     exit 1
    # fi
    
    exit 0
else
    echo ""
    echo "âŒ Build failed!"
    echo ""
    echo "Please fix the compilation errors before committing."
    echo "Run 'go build -o bin/hauk ./cmd/hauk/main.go' to see the errors."
    echo ""
    exit 1
fi
